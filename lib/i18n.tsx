"use client"

import type React from "react"

import { createContext, useContext, useEffect, useMemo, useState } from "react"

export type Lang = "en" | "hi" | "or" | "ar"
type Dict = Record<string, string>
type Dictionaries = Record<Lang, Dict>

const dictionaries: Dictionaries = {
  en: {
    appTitle: "URJANETRA",
    overview: "Overview",
    fleet: "Fleet",
    analytics: "Analytics",
    admin: "Admin",
    liveStatus: "Live Status",
    kpis: "KPIs",
    generation: "Generation",
    storage: "Storage",
    consumption: "Consumption",
    battery: "Battery",
    solar: "Solar",
    wind: "Wind",
    stateOfCharge: "State of Charge",
    stateOfHealth: "State of Health",
    cycles: "Cycles",
    alerts: "Alerts",
    acknowledge: "Acknowledge",
    escalate: "Escalate",
    siteMap: "Sites Map",
    sites: "Sites",
    siteDetails: "Site Details",
    performance: "Performance",
    carbonSavings: "Carbon Savings",
    dieselOffset: "Diesel Offset",
    communityImpact: "Community Impact",
    expectedVsActual: "Expected vs Actual",
    timeRange: "Time Range",
    hour: "Hour",
    day: "Day",
    month: "Month",
    year: "Year",
    widgets: "Widgets",
    editLayout: "Edit Layout",
    done: "Done",
    export: "Export",
    exportCSV: "Export CSV",
    exportJSON: "Export JSON",
    language: "Language",
    role: "Role",
    adminRole: "Admin",
    operatorRole: "Operator",
    technicianRole: "Technician",
    communityRole: "Community",
    govtRole: "Govt",
    controls: "Controls",
    startInverter: "Start Inverter",
    stopInverter: "Stop Inverter",
    rebootGateway: "Reboot Gateway",
    shedNonCritical: "Shed Non-critical",
    scheduleMaintenance: "Schedule Maintenance",
    site: "Site",
    health: "Health",
    status: "Status",
    critical: "Critical",
    warning: "Warning",
    info: "Info",
    acknowledged: "Acknowledged",
    filter: "Filter",
    forecast: "Forecast",
    batteryLifePrediction: "Battery Life Prediction",
    faultProbability: "Fault Probability",
    demandForecast: "Demand Forecast",
    lossAnalysis: "Loss Analysis",
    technicalLoss: "Technical Loss",
    nonTechnicalLoss: "Non-technical Loss",
    maintenanceTickets: "Maintenance Tickets",
    users: "Users",
    deviceRegistration: "Device Registration",
    localization: "Localization",
    reportScheduler: "Report Scheduler",
    demoMode: "Demo Mode",
  },
  hi: {
    appTitle: "उर्जानेत्र",
    overview: "ओवरव्यू",
    fleet: "फ्लीट",
    analytics: "एनालिटिक्स",
    Dashboard:" ",
    admin: "एडमिन",
    liveStatus: "लाइव स्थिति",
    kpis: "केपीआई",
    generation: "उत्पादन",
    storage: "भंडारण",
    consumption: "खपत",
    battery: "बैटरी",
    solar: "सौर",
    wind: "पवन",
    stateOfCharge: "चार्ज की स्थिति",
    stateOfHealth: "स्वास्थ्य की स्थिति",
    cycles: "सायकल",
    alerts: "अलर्ट",
    acknowledge: "स्वीकारें",
    escalate: "एस्केलेट",
    siteMap: "साइट मानचित्र",
    sites: "साइट्स",
    siteDetails: "साइट विवरण",
    performance: "प्रदर्शन",
    carbonSavings: "कार्बन बचत",
    dieselOffset: "डीज़ल ऑफ़सेट",
    communityImpact: "समुदाय प्रभाव",
    expectedVsActual: "अपेक्षित बनाम वास्तविक",
    timeRange: "समय सीमा",
    hour: "घंटा",
    day: "दिन",
    month: "महीना",
    year: "वर्ष",
    widgets: "विजेट्स",
    editLayout: "लेआउट संपादित करें",
    done: "पूर्ण",
    export: "निर्यात",
    exportCSV: "CSV निर्यात",
    exportJSON: "JSON निर्यात",
    language: "भाषा",
    role: "भूमिका",
    adminRole: "एडमिन",
    operatorRole: "ऑपरेटर",
    technicianRole: "तकनीशियन",
    communityRole: "समुदाय",
    govtRole: "सरकारी",
    controls: "कंट्रोल्स",
    startInverter: "इन्वर्टर चालू",
    stopInverter: "इन्वर्टर बंद",
    rebootGateway: "गेटवे रीबूट",
    shedNonCritical: "गैर-आवश्यक लोड घटाएं",
    scheduleMaintenance: "मेंटेनेंस शेड्यूल",
    site: "साइट",
    health: "स्वास्थ्य",
    status: "स्थिति",
    critical: "क्रिटिकल",
    warning: "चेतावनी",
    info: "सूचना",
    acknowledged: "स्वीकार किया",
    filter: "फ़िल्टर",
    forecast: "पूर्वानुमान",
    batteryLifePrediction: "बैटरी जीवन पूर्वानुमान",
    faultProbability: "दोष संभावना",
    demandForecast: "मांग पूर्वानुमान",
    lossAnalysis: "हानि विश्लेषण",
    technicalLoss: "तकनीकी हानि",
    nonTechnicalLoss: "गैर-तकनीकी हानि",
    maintenanceTickets: "मेंटेनेंस टिकट",
    users: "उपयोगकर्ता",
    deviceRegistration: "डिवाइस पंजीकरण",
    localization: "स्थानीयकरण",
    reportScheduler: "रिपोर्ट शेड्यूलर",
    demoMode: "डेमो मोड",
  },
  or: {
    appTitle: "ଉର୍ଜାନେତ୍ର",
    overview: "ସମୀକ୍ଷା",
    fleet: "ଫ୍ଲିଟ୍",
    analytics: "ବିଶ୍ଳେଷଣ",
    admin: "ଅ୍ୟାଡମିନ",
    liveStatus: "ସଜୀବ ଅବସ୍ଥା",
    kpis: "କେପିଆଇ",
    generation: "ଉତ୍ପାଦନ",
    storage: "ଷ୍ଟୋରେଜ୍",
    consumption: "ଖର୍ଚ୍ଚ",
    battery: "ବ୍ୟାଟେରୀ",
    solar: "ସୂର୍ଯ୍ୟ",
    wind: "ପବନ",
    stateOfCharge: "ଚାର୍ଜ ଅବସ୍ଥା",
    stateOfHealth: "ସ୍ୱାସ୍ଥ୍ୟ ଅବସ୍ଥା",
    cycles: "ସାଇକଲ୍‌",
    alerts: "ସତର୍କତା",
    acknowledge: "ସ୍ଵୀକାର",
    escalate: "ଏସ୍କାଲେଟ୍",
    siteMap: "ସାଇଟ୍ ମାନଚିତ୍ର",
    sites: "ସାଇଟ୍",
    siteDetails: "ସାଇଟ୍ ବିବରଣୀ",
    performance: "କାର୍ଯ୍ୟକୁଶଳତା",
    carbonSavings: "କାର୍ବନ ସେଭିଂସ୍",
    dieselOffset: "ଡିଜେଲ୍ ଅଫସେଟ୍",
    communityImpact: "ସମୁଦାୟ ପ୍ରଭାବ",
    expectedVsActual: "ଅପେକ୍ଷିତ ବିରୁଦ୍ଧେ ପ୍ରାକୃତିକ",
    timeRange: "ସମୟ ସୀମା",
    hour: "ଘଣ୍ଟା",
    day: "ଦିନ",
    month: "ମାସ",
    year: "ବର୍ଷ",
    widgets: "ୱିଜେଟ୍",
    editLayout: "ଲେଆଉଟ୍ ସମ୍ପାଦନ",
    done: "ସମାପ୍ତ",
    export: "ରପ୍ତାନି",
    exportCSV: "CSV ରପ୍ତାନି",
    exportJSON: "JSON ରପ୍ତାନି",
    language: "ଭାଷା",
    role: "ଭୂମିକା",
    adminRole: "ଅ୍ୟାଡମିନ",
    operatorRole: "ଅପରେଟର",
    technicianRole: "ଟେକ୍ନିଶିଆନ୍",
    communityRole: "ସମୁଦାୟ",
    govtRole: "ସରକାରୀ",
    controls: "ନିୟନ୍ତ୍ରଣ",
    startInverter: "ଇନଭର୍ଟର ଆରମ୍ଭ",
    stopInverter: "ଇନଭର୍ଟର ବନ୍ଦ",
    rebootGateway: "ଗେଟୱେ ରିବୁଟ୍",
    shedNonCritical: "ଅ-ଗୁରୁତ୍ୱପୂର୍ଣ୍ଣ ଲୋଡ୍ କମାନ୍ତୁ",
    scheduleMaintenance: "ରକ୍ଷାବେକ୍ଷଣ ତାରିଖ",
    site: "ସାଇଟ୍",
    health: "ସ୍ୱାସ୍ଥ୍ୟ",
    status: "ସ୍ଥିତି",
    critical: "ଗୁରୁତ୍ୱପୂର୍ଣ୍ଣ",
    warning: "ଚେତାବନୀ",
    info: "ସୂଚନା",
    acknowledged: "ସ୍ୱୀକୃତ",
    filter: "ଫିଲ୍ଟର",
    forecast: "ପୂର୍ବାନୁମାନ",
    batteryLifePrediction: "ବ୍ୟାଟେରୀ ଆୟୁ ପୂର୍ବାନୁମାନ",
    faultProbability: "ତ୍ରୁଟି ସମ୍ଭାଵନା",
    demandForecast: "ଚାହିଦା ପୂର୍ବାନୁମାନ",
    lossAnalysis: "ହାନି ବିଶ୍ଳେଷଣ",
    technicalLoss: "ପ୍ରାଯୁକ୍ତିକ ହାନି",
    nonTechnicalLoss: "ଅପ୍ରାଯୁକ୍ତିକ ହାନି",
    maintenanceTickets: "ରକ୍ଷାବେକ୍ଷଣ ଟିକେଟ୍",
    users: "ଉପଯୋଗକର୍ତ୍ତା",
    deviceRegistration: "ଡିଭାଇସ୍ ରେଜିଷ୍ଟ୍ରେସନ୍",
    localization: "ସ୍ଥାନୀକୀକରଣ",
    reportScheduler: "ରିପୋର୍ଟ ସ୍କେଡ୍ୟୁଲର୍",
    demoMode: "ଡେମୋ ମୋଡ୍",
  },
  ar: {
    appTitle: "أورجانيترا",
    overview: "نظرة عامة",
    fleet: "الأسطول",
    analytics: "التحليلات",
    admin: "الإدارة",
    liveStatus: "الحالة الحية",
    kpis: "المؤشرات",
    generation: "التوليد",
    consumption: "الاستهلاك",
    storage: "التخزين",
    battery: "البطارية",
    solar: "شمسي",
    wind: "رياح",
    stateOfCharge: "حالة الشحن",
    stateOfHealth: "حالة الصحة",
    cycles: "الدورات",
    alerts: "التنبيهات",
    acknowledge: "تأكيد",
    escalate: "تصعيد",
    siteMap: "خريطة المواقع",
    sites: "المواقع",
    siteDetails: "تفاصيل الموقع",
    performance: "الأداء",
    carbonSavings: "تخفيض الكربون",
    dieselOffset: "تعويض الديزل",
    communityImpact: "أثر المجتمع",
    expectedVsActual: "المتوقع مقابل الفعلي",
    timeRange: "نطاق الوقت",
    hour: "ساعة",
    day: "يوم",
    month: "شهر",
    year: "سنة",
    widgets: "الويدجت",
    editLayout: "تعديل التخطيط",
    done: "تم",
    export: "تصدير",
    exportCSV: "تصدير CSV",
    exportJSON: "تصدير JSON",
    language: "اللغة",
    role: "الدور",
    adminRole: "مسؤول",
    operatorRole: "مشغّل",
    technicianRole: "فني",
    communityRole: "مجتمعي",
    govtRole: "حكومي",
    controls: "التحكم",
    startInverter: "تشغيل العاكس",
    stopInverter: "إيقاف العاكس",
    rebootGateway: "إعادة تشغيل البوابة",
    shedNonCritical: "خفض الأحمال غير الحرجة",
    scheduleMaintenance: "جدولة الصيانة",
    site: "الموقع",
    health: "الصحة",
    status: "الحالة",
    critical: "حرج",
    warning: "تحذير",
    info: "معلومة",
    acknowledged: "مؤكّد",
    filter: "تصفية",
    forecast: "تنبؤ",
    batteryLifePrediction: "توقع عمر البطارية",
    faultProbability: "احتمال العطل",
    demandForecast: "توقع الطلب",
    lossAnalysis: "تحليل الفواقد",
    technicalLoss: "فقد تقني",
    nonTechnicalLoss: "فقد غير تقني",
    maintenanceTickets: "تذاكر الصيانة",
    users: "المستخدمون",
    deviceRegistration: "تسجيل الأجهزة",
    localization: "التعريب",
    reportScheduler: "جدولة التقارير",
    demoMode: "وضع العرض",
  },
}

type I18nContextType = {
  lang: Lang
  dir: "ltr" | "rtl"
  t: (key: string) => string
  setLang: (l: Lang) => void
}

const I18nContext = createContext<I18nContextType | null>(null)

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [lang, setLangState] = useState<Lang>("en")
  useEffect(() => {
    const saved = typeof window !== "undefined" ? (localStorage.getItem("lang") as Lang | null) : null
    if (saved) setLangState(saved)
  }, [])
  const setLang = (l: Lang) => {
    setLangState(l)
    if (typeof window !== "undefined") localStorage.setItem("lang", l)
  }
  const dir = lang === "ar" ? "rtl" : "ltr"
  const t = useMemo(() => {
    const dict = dictionaries[lang] || dictionaries["en"]
    return (key: string) => dict[key] || dictionaries["en"][key] || key
  }, [lang])
  return (
    <I18nContext.Provider value={{ lang, dir, t, setLang }}>
      <div dir={dir}>{children}</div>
    </I18nContext.Provider>
  )
}

export function useI18n() {
  const ctx = useContext(I18nContext)
  if (!ctx) throw new Error("useI18n must be used within I18nProvider")
  return ctx
}
